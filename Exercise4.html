
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Exercise 4: Thermodynamic Properties &#8212; Software Tools from Atomistics to Phase Diagrams</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Phase Diagram" href="PhaseDiagram.html" />
    <link rel="prev" title="Thermodynamic Properties" href="ThermodynamicProperties.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo_dark.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Software Tools from Atomistics to Phase Diagrams</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Introduction.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Atomisticstructures.html">
   Atomistic Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Exercise1.html">
   Exercise 1: Atomistic Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SimulationCodes.html">
   Simulation Codes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Exercise2.html">
   Exercise 2: Simulation Codes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DensityFunctionalTheory.html">
   Density Functional Theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Exercise3.html">
   Exercise 3: Density functional theory
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ThermodynamicProperties.html">
   Thermodynamic Properties
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Exercise 4: Thermodynamic Properties
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PhaseDiagram.html">
   Phase Diagram
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Exercise4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/pyiron/phasediagram-workshop-2020/master?urlpath=tree/Exercise4.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reminder">
   Reminder
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#harmonic-approximation">
   Harmonic Approximation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#minimization">
     Minimization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phonon-calculation">
     Phonon Calculation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#density-of-states">
     Density of States
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#free-energy-calculation">
     Free energy calculation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#heat-capacity">
     Heat capacity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#entropy">
     Entropy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quasi-harmonic-approximation">
   Quasi-harmonic Approximation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculation">
     Calculation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#free-energy">
     Free Energy
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pressure-optimised-thermodynamic-properties">
     Pressure optimised thermodynamic properties
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#concentration-dependence">
   Concentration dependence
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-endmembers">
     Create Endmembers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-concentrations">
     Select concentrations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sqs-structures">
     SQS Structures
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fcc">
       FCC
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bcc">
       BCC
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#collect-structures">
     Collect structures
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="exercise-4-thermodynamic-properties">
<h1>Exercise 4: Thermodynamic Properties<a class="headerlink" href="#exercise-4-thermodynamic-properties" title="Permalink to this headline">¶</a></h1>
<p>The scope of this first exercise is to become familar with:</p>
<ul class="simple">
<li><p>with the phonopy interface in pyiron to calculate free energies,</p></li>
<li><p>the harmonic and quasi-harmonic approximation and</p></li>
<li><p>how to combine multiple pyiron jobs in one workflow.</p></li>
</ul>
<p>With this last section we have all the necessary tools to calculate phase diagrams.</p>
<div class="section" id="reminder">
<h2>Reminder<a class="headerlink" href="#reminder" title="Permalink to this headline">¶</a></h2>
<p>In the first session we learned how to create a pyiron project object and then use this pyiron project object to create atomistic structure objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the Project object</span>
<span class="kn">from</span> <span class="nn">pyiron</span> <span class="kn">import</span> <span class="n">____</span>

<span class="c1"># Create a Project object instance for a project named atomistics</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">____</span><span class="p">(</span><span class="s2">&quot;simulations&quot;</span><span class="p">)</span>

<span class="c1"># Create a cubic aluminum fcc structure</span>
<span class="n">al_fcc</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">create_ase_bulk</span><span class="p">(</span><span class="n">____</span><span class="p">,</span> <span class="n">_____</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Confirm the final structure has 4 atoms by calculating the length of the structure object</span>
<span class="n">____</span><span class="p">(</span><span class="n">al_fcc</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="harmonic-approximation">
<h2>Harmonic Approximation<a class="headerlink" href="#harmonic-approximation" title="Permalink to this headline">¶</a></h2>
<p>Calculate the phonons at the 0K equilibrium volume and then use the model of the harmonic oscillator to calculate the free energy, heat capacity and entropy contribution. These calculation can again be either executed with density functional theory (DFT) or interatomic potentials. In this workshop we use interatomic potentials to accelerate the process, but the same simulation protocol can also be executed with DFT code as quantum engine.</p>
<div class="section" id="minimization">
<h3>Minimization<a class="headerlink" href="#minimization" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a LAMMPS job to relax the structure - here we the regular minimization</span>
<span class="c1"># for DFT calculation it is recommended to calculate the energy volume curve </span>
<span class="c1"># to identify the equilibrium volume as discussed in the previous section. </span>
<span class="c1"># Name the minimization job &quot;lmp_mini&quot;.</span>
<span class="n">job_mini</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">Lammps</span><span class="p">,</span>
    <span class="n">job_name</span><span class="o">=</span><span class="n">________</span>
<span class="p">)</span>

<span class="c1"># Assign the the cubic fcc aluminium structure to the LAMMPS quantum engine job</span>
<span class="n">job_mini</span><span class="o">.</span><span class="n">_________</span> <span class="o">=</span> <span class="n">_________</span>

<span class="c1"># Set the pressure during the minimization to zero </span>
<span class="n">job_mini</span><span class="o">.</span><span class="n">calc_minimize</span><span class="p">(</span><span class="n">_________</span><span class="o">=</span><span class="n">_______</span><span class="p">)</span>

<span class="c1"># Execute the minimization</span>
<span class="n">job_mini</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="phonon-calculation">
<h3>Phonon Calculation<a class="headerlink" href="#phonon-calculation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a interatomic template job with the LAMMPS quantum engine named lmp</span>
<span class="n">job_lammp_template</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">Lammps</span><span class="p">,</span>
    <span class="n">job_name</span><span class="o">=</span><span class="n">________</span>
<span class="p">)</span>

<span class="c1"># Assign the the final structure of the minimization calculation job as input structure</span>
<span class="n">job_lammp_template</span><span class="o">.</span><span class="n">_________</span> <span class="o">=</span> <span class="n">_________</span><span class="o">.</span><span class="n">get_structure</span><span class="p">()</span>

<span class="c1"># We calculate the bulk energy using the template job in a separate calculation named &quot;lmp_bulk&quot;</span>
<span class="n">job_bulk</span> <span class="o">=</span> <span class="n">job_lammp_template</span><span class="o">.</span><span class="n">copy_to</span><span class="p">(</span>
    <span class="n">new_job_name</span><span class="o">=</span><span class="n">___________</span><span class="p">,</span> 
    <span class="n">new_database_entry</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Create a Phonopy job from the LAMMPS quantum engine named phono</span>
<span class="n">phono</span> <span class="o">=</span> <span class="n">job_lammp_template</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">PhonopyJob</span><span class="p">,</span>
    <span class="n">job_name</span><span class="o">=</span><span class="n">________</span>
<span class="p">)</span>

<span class="c1"># Execute the Phonopy calculation and the bulk calculation</span>
<span class="n">job_bulk</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">phono</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="density-of-states">
<h3>Density of States<a class="headerlink" href="#density-of-states" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the density of states over energy </span>
<span class="n">phono</span><span class="o">.</span><span class="n">plot_dos</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="free-energy-calculation">
<h3>Free energy calculation<a class="headerlink" href="#free-energy-calculation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To calculate the thermodynamic properties we define a temperature range</span>
<span class="c1"># Starting a 0K up to the 800K using 41 steps. We import numpy and define</span>
<span class="c1"># a linear space starting at 0 to 800 with 41 steps. </span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">______</span><span class="p">,</span> <span class="n">_______</span><span class="p">,</span> <span class="n">_____</span><span class="p">)</span>

<span class="c1"># Calculate the thermal properties for a the defined temperature range </span>
<span class="n">bulk_thermal_properties</span> <span class="o">=</span> <span class="n">phono</span><span class="o">.</span><span class="n">get_thermal_properties</span><span class="p">(</span><span class="n">temperatures</span><span class="o">=</span><span class="n">_________</span><span class="p">)</span> 

<span class="c1"># Import the matplotlib library for plotting. As we are using jupyter notebooks </span>
<span class="c1"># for combining code, documentation and visualisation, we also need the jupyter magic for matplotlib. </span>
<span class="c1"># https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-matplotlib</span>
<span class="o">%</span><span class="k">matplotlib</span> inline 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Plot the free energy over temperature by adding the inner bulk energy and the free vibrational energy </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">__________</span><span class="p">,</span> <span class="n">job_bulk</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">energy_pot</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bulk_thermal_properties</span><span class="o">.</span><span class="n">free_energies</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature [K]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Free energy  ($U+F_</span><span class="si">{vib}</span><span class="s2">$)  [eV]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="heat-capacity">
<h3>Heat capacity<a class="headerlink" href="#heat-capacity" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the heat capacity over temperature</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temperatures</span><span class="p">,</span> <span class="n">bulk_thermal_properties</span><span class="o">.</span><span class="n">cv</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature [K]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Heat capacity&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="entropy">
<h3>Entropy<a class="headerlink" href="#entropy" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the entropy over temperature</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temperatures</span><span class="p">,</span> <span class="n">bulk_thermal_properties</span><span class="o">.</span><span class="n">entropy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature [K]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Entropy&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="quasi-harmonic-approximation">
<h2>Quasi-harmonic Approximation<a class="headerlink" href="#quasi-harmonic-approximation" title="Permalink to this headline">¶</a></h2>
<p>The quasi-harmonic approximation includes the thermal volume expansion in contrast to the harmonic approximation which only considers the 0K equilibrium volume.</p>
<div class="section" id="calculation">
<h3>Calculation<a class="headerlink" href="#calculation" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a interatomic template job with the LAMMPS quantum engine named lmp_strain</span>
<span class="n">job_strain_template</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">Lammps</span><span class="p">,</span>
    <span class="n">job_name</span><span class="o">=</span><span class="n">________</span>
<span class="p">)</span>

<span class="c1"># Assign the the final structure of the minimization calculation job as input structure</span>
<span class="n">job_strain_template</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">________</span><span class="o">.</span><span class="n">get_structure</span><span class="p">()</span>

<span class="c1"># Create a secondary template job to calculate the bulk energy</span>
<span class="c1"># The second template job we name lmp_bulk_strain </span>
<span class="n">job_strain_bulk</span> <span class="o">=</span> <span class="n">job_strain_template</span><span class="o">.</span><span class="n">copy_to</span><span class="p">(</span>
    <span class="n">new_job_name</span><span class="o">=</span><span class="n">______________</span><span class="p">,</span> 
    <span class="n">new_database_entry</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># Use this second template job to create a Murnaghan job named murn_strain</span>
<span class="n">murn_strain</span> <span class="o">=</span> <span class="n">job_strain_bulk</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">Murnaghan</span><span class="p">,</span>
    <span class="n">job_name</span><span class="o">=</span><span class="n">____________</span>
<span class="p">)</span>

<span class="c1"># Create a Phonopy job from the original LAMMPS quantum engine named phono_strain</span>
<span class="n">phono_strain</span> <span class="o">=</span> <span class="n">job_strain_template</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">PhonopyJob</span><span class="p">,</span>
    <span class="n">job_name</span><span class="o">=</span><span class="n">____________</span>
<span class="p">)</span>

<span class="c1"># Assign this Phonopy job to a QuasiHarmonicJob to calculate the phonons at multiple volumes</span>
<span class="c1"># This QuasiHarmonicJob is named quasi_strain</span>
<span class="n">quasi_strain</span> <span class="o">=</span> <span class="n">phono_strain</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">QuasiHarmonicJob</span><span class="p">,</span>
    <span class="n">job_name</span><span class="o">=</span><span class="n">_______________</span>
<span class="p">)</span>

<span class="c1"># Set the end temperature to be 800K and set the number of temperature steps to 41 </span>
<span class="n">quasi_strain</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s2">&quot;temperature_end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">________</span>
<span class="n">quasi_strain</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s2">&quot;temperature_steps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_______</span>

<span class="c1"># Execute the QuasiHarmonicJob calculation and the bulk calculation</span>
<span class="n">murn_strain</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">quasi_strain</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="free-energy">
<h3>Free Energy<a class="headerlink" href="#free-energy" title="Permalink to this headline">¶</a></h3>
<p>To calculate the heat capacity and entropy at constant pressure, the free energy at constant temperature is plotted over volume. The minimum at constant temperature defines the volume of constant pressure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualise the temperature dependent free energy over volume using a matplotlib color map</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>

<span class="c1"># Iterate over the the output of the QuasiHarmonicJob to plot the temperature dependent free energy over volume </span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">free_energy</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span><span class="n">____________</span><span class="p">[</span><span class="s2">&quot;output/temperatures&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> 
            <span class="n">____________</span><span class="p">[</span><span class="s2">&quot;output/free_energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> 
            <span class="n">____________</span><span class="p">[</span><span class="s2">&quot;output/volumes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)):</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">i</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">quasi_strain</span><span class="p">[</span><span class="s2">&quot;output/temperatures&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
    <span class="c1"># Add the energy of the Murnaghan Job to the vibrational free energy</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">free_energy</span> <span class="o">+</span> <span class="n">_________</span><span class="p">[</span><span class="s2">&quot;output/energy&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

<span class="c1"># Add labels to the plot     </span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Volume&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Free Energy&quot;</span><span class="p">)</span>

<span class="c1"># Add a color bar to visualise the temperature dependence </span>
<span class="n">temperatures</span> <span class="o">=</span> <span class="n">quasi_strain</span><span class="p">[</span><span class="s2">&quot;output/temperatures&quot;</span><span class="p">]</span>
<span class="n">normalize</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">temperatures</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">temperatures</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">scalarmappaple</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
<span class="n">scalarmappaple</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">temperatures</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">scalarmappaple</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pressure-optimised-thermodynamic-properties">
<h3>Pressure optimised thermodynamic properties<a class="headerlink" href="#pressure-optimised-thermodynamic-properties" title="Permalink to this headline">¶</a></h3>
<p>After calculating the volume expansion from the free energy surface over temperature and volume, the entropy and heat capacity are calculated at these optimised volumes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use the optimise_volume() function of the QuasiHarmonicJob  </span>
<span class="n">v0_lst</span><span class="p">,</span> <span class="n">free_eng_lst</span><span class="p">,</span> <span class="n">entropy_lst</span><span class="p">,</span> <span class="n">cv_lst</span> <span class="o">=</span> <span class="n">quasi_strain</span><span class="o">.</span><span class="n">optimise_volume</span><span class="p">(</span>
    <span class="c1"># It requires the output energy of the energy volume curve as additional input </span>
    <span class="n">bulk_eng</span><span class="o">=</span><span class="n">murn_strain</span><span class="p">[</span><span class="s2">&quot;output/energy&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Plot the finite temperature volume over temperature </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">quasi_strain</span><span class="p">[</span><span class="s2">&quot;output/temperatures&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">__________</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Volume&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot the pressure optimised free energy over temperature </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">quasi_strain</span><span class="p">[</span><span class="s2">&quot;output/temperatures&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">___________</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Free Energy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot the pressure optimised entropy over temperature </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">quasi_strain</span><span class="p">[</span><span class="s2">&quot;output/temperatures&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">____________</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Entropy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot the pressure optimised heat capacity over temperature </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">quasi_strain</span><span class="p">[</span><span class="s2">&quot;output/temperatures&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">____________</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Heat Capacity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="concentration-dependence">
<h2>Concentration dependence<a class="headerlink" href="#concentration-dependence" title="Permalink to this headline">¶</a></h2>
<p>With the temperature dependence of a unary discussed above the next step is the concentration dependence. For the concentration dependence we use the special quasi-random structures introduced in the first section to calculate mixed structures. Here we select the Ni-Cr phase diagram, which can be calculated using the <code class="docutils literal notranslate"><span class="pre">2018--Howells-C-A--Cr-Ni--LAMMPS--ipr1</span></code> potential.</p>
<div class="section" id="create-endmembers">
<h3>Create Endmembers<a class="headerlink" href="#create-endmembers" title="Permalink to this headline">¶</a></h3>
<p>Start by creating the endmembers of both phases the nickel fcc endmember and the chromium bcc endmember.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the Nickel fcc endmember </span>
<span class="n">ni_fcc</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">create_ase_bulk</span><span class="p">(</span><span class="n">____</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Create the Chromium bcc endmember </span>
<span class="n">cr_bcc_small</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">create_ase_bulk</span><span class="p">(</span><span class="n">____</span><span class="p">,</span> <span class="n">cubic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Repeat the bcc cell to have the same number of atoms as the fcc cell</span>
<span class="n">cr_bcc</span> <span class="o">=</span> <span class="n">cr_bcc_small</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="n">___</span><span class="p">,</span> <span class="n">___</span><span class="p">,</span> <span class="n">____</span><span class="p">])</span>

<span class="c1"># Compare the length of both structure</span>
<span class="nb">len</span><span class="p">(</span><span class="n">cr_bcc</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ni_fcc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="select-concentrations">
<h3>Select concentrations<a class="headerlink" href="#select-concentrations" title="Permalink to this headline">¶</a></h3>
<p>One advantage of atomistic simulation is the ability to calculate free energies of unstable phases. In this case we calculate both the fcc phase and the bcc phase for all temperature ranges. Starting at 0% Cr up to 100%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create 3 mixed concentrations for a 4 atom cell within the range 0.0 to 1.0 </span>
<span class="c1"># for example these could be 0.25, 0.5 and 0.75</span>
<span class="n">concentration_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">____</span><span class="p">,</span> <span class="n">____</span><span class="p">,</span> <span class="n">___</span><span class="p">]</span>

<span class="c1"># Create an FCC Cr lattice by replacing all elements of the FCC Ni lattice with Cr</span>
<span class="n">cr_fcc</span> <span class="o">=</span> <span class="n">______</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cr_fcc</span><span class="p">[:]</span> <span class="o">=</span> <span class="s2">&quot;Cr&quot;</span>

<span class="c1"># Create an BCC Ni lattice by replacing all elements of the BCC Cr lattice with Ni</span>
<span class="n">ni_bcc</span> <span class="o">=</span> <span class="n">________</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">ni_bcc</span><span class="p">[:]</span> <span class="o">=</span> <span class="s2">&quot;Ni&quot;</span>

<span class="n">concentration_total_lst</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">+</span> <span class="n">concentration_lst</span> <span class="o">+</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sqs-structures">
<h3>SQS Structures<a class="headerlink" href="#sqs-structures" title="Permalink to this headline">¶</a></h3>
<p>To calculate SQS structures for multiple concentrations the SQSMaster job is used, it takes an SQS job as an input in addtion to a list of concentrations. Here it is used to calculate SQS structures for both the FCC phase and the BCC phase.</p>
<div class="section" id="fcc">
<h4>FCC<a class="headerlink" href="#fcc" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an SQS job named sqs_job_ni</span>
<span class="n">sqs_job_ni</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">SQSJob</span><span class="p">,</span> 
    <span class="n">job_name</span><span class="o">=</span><span class="n">__________</span>
<span class="p">)</span>

<span class="c1"># Assign the cubic nickel fcc structure to the SQS job</span>
<span class="n">sqs_job_ni</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">______</span>

<span class="c1"># Limit the number of iterations to 1000</span>
<span class="n">sqs_job_ni</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_____</span>

<span class="c1"># Create an SQSMaster named sqs_master_ni</span>
<span class="n">master_ni</span> <span class="o">=</span> <span class="n">sqs_job_ni</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">SQSMaster</span><span class="p">,</span> 
    <span class="n">job_name</span><span class="o">=</span><span class="n">__________</span>
<span class="p">)</span>

<span class="c1"># Assign the mixed concentration list defined above - not the total concentration list which includes the end members</span>
<span class="n">master_ni</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s2">&quot;fraction_lst&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">__________</span>
<span class="n">master_ni</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s2">&quot;species_one&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Ni&quot;</span>
<span class="n">master_ni</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s2">&quot;species_two&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cr&quot;</span>

<span class="c1"># Execute the calculation</span>
<span class="n">master_ni</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="bcc">
<h4>BCC<a class="headerlink" href="#bcc" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an SQS job named sqs_job_cr</span>
<span class="n">sqs_job_cr</span> <span class="o">=</span> <span class="n">pr</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">SQSJob</span><span class="p">,</span> 
    <span class="n">job_name</span><span class="o">=</span><span class="n">_________</span>
<span class="p">)</span>

<span class="c1"># Assign the cubic chromium bcc structure to the SQS job</span>
<span class="n">sqs_job_cr</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">__________</span>

<span class="c1"># Limit the number of iterations to 1000</span>
<span class="n">sqs_job_cr</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;iterations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_______</span>

<span class="c1"># Create an SQSMaster named sqs_master_cr</span>
<span class="n">master_cr</span> <span class="o">=</span> <span class="n">sqs_job_cr</span><span class="o">.</span><span class="n">create_job</span><span class="p">(</span>
    <span class="n">job_type</span><span class="o">=</span><span class="n">pr</span><span class="o">.</span><span class="n">job_type</span><span class="o">.</span><span class="n">SQSMaster</span><span class="p">,</span> 
    <span class="n">job_name</span><span class="o">=</span><span class="n">_________</span>
<span class="p">)</span>

<span class="c1"># Assign the mixed concentration list defined above - not the total concentration list which includes the end members</span>
<span class="n">master_cr</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s2">&quot;fraction_lst&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_________</span>
<span class="n">master_cr</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s2">&quot;species_one&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Ni&quot;</span>
<span class="n">master_cr</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s2">&quot;species_two&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cr&quot;</span>

<span class="c1"># Execute the calculation</span>
<span class="n">master_cr</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="collect-structures">
<h3>Collect structures<a class="headerlink" href="#collect-structures" title="Permalink to this headline">¶</a></h3>
<p>At this point ten structures have been generated five for each phase. Now each of these structures has to be minimized to apply the quasi-harmonic approximation for each of them. In the interest of time this step is skipped here and we only compile the list of structures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine the end members with the structures from the SQS masters </span>
<span class="c1"># to have a total of five structures for each phase</span>
<span class="n">structure_fcc_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">______</span><span class="p">]</span> <span class="o">+</span> <span class="n">master_ni</span><span class="o">.</span><span class="n">list_structures</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">______</span><span class="p">]</span>
<span class="n">structure_bcc_lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">______</span><span class="p">]</span> <span class="o">+</span> <span class="n">master_cr</span><span class="o">.</span><span class="n">list_structures</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">______</span><span class="p">]</span>

<span class="nb">len</span><span class="p">(</span><span class="n">structure_fcc_lst</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">structure_bcc_lst</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>In this section you learned:</p>
<ul class="simple">
<li><p>how to calculate free energies using the harmonic and the quasi-harmonic approximation.</p></li>
<li><p>how hierachical workflows can be constructed in pyiron by combining multiple master jobs.</p></li>
<li><p>and how to generate mixed phases with special quasi random structures.</p></li>
</ul>
<p>Suggestions:</p>
<ul class="simple">
<li><p>Calculate the concentration dependent volume expansion for both the FCC and the BCC phase.</p></li>
<li><p>Calculate the harmonic approximation for a single SQS structure. As the mixed phase breaks the symmetry additional displacments are necessary. Phonopy automatically identifies the necessary displacements, but these calculation take more time.</p></li>
<li><p>Use the option <code class="docutils literal notranslate"><span class="pre">job.server.run_mode.interactive=True</span></code> for the LAMMPS jobs before they are assigned to the phonopy jobs to accelerate the calculations by using LAMMPS as a C-library rather than calling the executable by writing output and input files.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="ThermodynamicProperties.html" title="previous page">Thermodynamic Properties</a>
    <a class='right-next' id="next-link" href="PhaseDiagram.html" title="next page">Phase Diagram</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Jan Janssen<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>